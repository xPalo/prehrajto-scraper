<h1 class="text-center mb-4"><%= t(:'video.index') %></h1>

<div class="container-fluid px-3">
  <div class="row">
    <% @videos.each do |video| %>
      <div class="col-md-6 col-lg-4 mb-4">
        <div class="card h-100 shadow-sm">
          <div class="card-body d-flex flex-column">
            <h5 class="card-title mb-2">
              <%= link_to video.original_filename.truncate(40), video_path(video), class: "text-decoration-none" %>
            </h5>

            <p class="card-text mb-1 text-muted">
              <strong><%= t('video.file_size') %>:</strong>
              <%= number_to_human_size(video.file_size) if video.file_size %>
            </p>

            <% if video.duration.present? && video.duration > 0 %>
              <p class="card-text mb-1 text-muted">
                <strong><%= t('video.duration') %>:</strong>
                <%= Time.at(video.duration).utc.strftime("%H:%M:%S") %>
              </p>
            <% end %>

            <p class="card-text mb-1 text-muted">
              <strong><%= t('created_at') %>:</strong>
              <%= video.created_at.strftime("%-d. %-m. %Y %H:%M") %>
            </p>

            <p class="mt-auto mb-0">
              <span class="badge <%= video_status_badge_class(video.status) %>">
                <%= t("video.status_#{video.status}") %>
              </span>
            </p>
          </div>

          <div class="card-footer d-flex justify-content-between align-items-center">
            <%= link_to t('show'), video_path(video), class: "btn btn-sm btn-outline-primary rounded-pill" %>
            <% if video.completed? %>
              <%= link_to t('video.download'), download_video_path(video), class: "btn btn-sm btn-outline-success rounded-pill" %>
            <% end %>
            <%= button_to t('delete'), video_path(video), method: :delete, data: { confirm: t('delete_confirm') }, class: "btn btn-sm btn-outline-danger rounded-pill" %>
          </div>
        </div>
      </div>
    <% end %>

    <div class="col-md-6 col-lg-4 mb-4">
      <%= link_to new_video_path, class: "card h-100 shadow-sm d-flex align-items-center justify-content-center text-decoration-none text-muted hover-zoom", style: "min-height: 220px;" do %>
        <div class="display-1">+</div>
        <div class="h5 mt-2"><%= t('video.new') %></div>
      <% end %>
    </div>
  </div>
</div>

<script type="text/javascript" charset="utf-8">
  $(document).on("turbo:load", function() {
    $('.card').each(function(index) {
      var card = $(this);
      setTimeout(function() {
        card.addClass('loaded');
      }, index * 150);
    });
  });
</script>
